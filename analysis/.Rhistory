img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$spruce_score1_bayenv~abs(PE_sub$spruce_correlation)))
mtext("Phenotype correlation with environment",side = 1, outer=TRUE)
mtext(PE_pheno_name,side = 3, outer=TRUE)
mtext("Genome Score",side = 2, outer=TRUE)
dev.off()
}
j
PE_sub <- PE2[PE2$Phenotype==phens[j],]
PE_pheno_name <- as.character(phens[j])
files_sub <- files[grep(PE_pheno_name,files)]
PE_sub
phens[j]
levels(PE2$Phenotype)
PE_sub <- PE2[PE2$Phenotype==phens[j],]
PE_sub
sum(PE2$pine_score1_bayenv)>0
if(!(is.na(sum(PE2$pine_score1_bayenv)))
for (j in seq_along(phens)){
## subset dataframe to get just this Phenotype
PE_sub <- PE2[PE2$Phenotype==phens[j],]
if(!(is.na(sum(PE2$pine_score1_bayenv))){
PE_pheno_name <- as.character(phens[j])
files_sub <- files[grep(PE_pheno_name,files)]
### pine
m <- max(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_min <- min(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_range <- m-m_min
mx <- max(c(abs(PE_sub$pine_correlation),abs(PE_sub$spruce_correlation)))
pdf(paste("figure_PEGA/",PE_pheno_name,".pdf", sep=""), width = 7, height=14,bg="transparent")
par(mfrow=c(2,1), mar=c(3,3,2,1), oma=c(2,2,2,0))
scale <- 10
### PINE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m_range/10,m+m_range/10), type='n', bty="n", main="Pine", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"pine.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$pine_correlation[i])-mx/scale
xright <- abs(PE_sub$pine_correlation[i])+mx/scale
ybottom <- PE_sub$pine_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$pine_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$pine_score1_bayenv~abs(PE_sub$pine_correlation)))
### SPRUCE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m/10,m+m/10), type='n', bty="n", main="Spruce", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"spruce.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$spruce_correlation[i])-mx/scale
xright <- abs(PE_sub$spruce_correlation[i])+mx/scale
ybottom <- PE_sub$spruce_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$spruce_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$spruce_score1_bayenv~abs(PE_sub$spruce_correlation)))
mtext("Phenotype correlation with environment",side = 1, outer=TRUE)
mtext(PE_pheno_name,side = 3, outer=TRUE)
mtext("Genome Score",side = 2, outer=TRUE)
dev.off()
}#end if not NA
}
i
j
phens <- levels(PE2$Phenotype)
files <- list.files("figure_new","^noaxes")
for (j in seq_along(phens)){
## subset dataframe to get just this Phenotype
PE_sub <- PE2[PE2$Phenotype==phens[j],]
if(!(is.na(sum(PE_sub$pine_score1_bayenv))){
PE_pheno_name <- as.character(phens[j])
files_sub <- files[grep(PE_pheno_name,files)]
### pine
m <- max(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_min <- min(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_range <- m-m_min
mx <- max(c(abs(PE_sub$pine_correlation),abs(PE_sub$spruce_correlation)))
pdf(paste("figure_PEGA/",PE_pheno_name,".pdf", sep=""), width = 7, height=14,bg="transparent")
par(mfrow=c(2,1), mar=c(3,3,2,1), oma=c(2,2,2,0))
scale <- 10
### PINE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m_range/10,m+m_range/10), type='n', bty="n", main="Pine", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"pine.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$pine_correlation[i])-mx/scale
xright <- abs(PE_sub$pine_correlation[i])+mx/scale
ybottom <- PE_sub$pine_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$pine_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$pine_score1_bayenv~abs(PE_sub$pine_correlation)))
### SPRUCE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m/10,m+m/10), type='n', bty="n", main="Spruce", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"spruce.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$spruce_correlation[i])-mx/scale
xright <- abs(PE_sub$spruce_correlation[i])+mx/scale
ybottom <- PE_sub$spruce_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$spruce_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$spruce_score1_bayenv~abs(PE_sub$spruce_correlation)))
mtext("Phenotype correlation with environment",side = 1, outer=TRUE)
mtext(PE_pheno_name,side = 3, outer=TRUE)
mtext("Genome Score",side = 2, outer=TRUE)
dev.off()
}#end if not NA
}
for (j in seq_along(phens)){
## subset dataframe to get just this Phenotype
PE_sub <- PE2[PE2$Phenotype==phens[j],]
if(!(is.na(sum(PE_sub$pine_score1_bayenv)))){
PE_pheno_name <- as.character(phens[j])
files_sub <- files[grep(PE_pheno_name,files)]
### pine
m <- max(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_min <- min(c(PE_sub$pine_score1_bayenv,PE_sub$spruce_score1_bayenv))
m_range <- m-m_min
mx <- max(c(abs(PE_sub$pine_correlation),abs(PE_sub$spruce_correlation)))
pdf(paste("figure_PEGA/",PE_pheno_name,".pdf", sep=""), width = 7, height=14,bg="transparent")
par(mfrow=c(2,1), mar=c(3,3,2,1), oma=c(2,2,2,0))
scale <- 10
### PINE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m_range/10,m+m_range/10), type='n', bty="n", main="Pine", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"pine.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$pine_correlation[i])-mx/scale
xright <- abs(PE_sub$pine_correlation[i])+mx/scale
ybottom <- PE_sub$pine_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$pine_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$pine_score1_bayenv~abs(PE_sub$pine_correlation)))
### SPRUCE #####
##############
plot(c(0-mx/10,mx+mx/10),c(m_min-m/10,m+m/10), type='n', bty="n", main="Spruce", las=1)
### Match names
for (i in 1:nrow(PE_sub)){
PE_envi_name <- as.character(PE_sub$Environment[i])
### pine
f <- paste("figure_new/noaxes", PE_pheno_name,"__", PE_envi_name,"spruce.tiff",sep="")
img <- readTIFF(f)
xleft <- abs(PE_sub$spruce_correlation[i])-mx/scale
xright <- abs(PE_sub$spruce_correlation[i])+mx/scale
ybottom <- PE_sub$spruce_score1_bayenv[i]-m_range/scale
ytop <- PE_sub$spruce_score1_bayenv[i]+m_range/scale
transparent <- img[,,4] == 0
img <- as.raster(img[,,1:3])
img[transparent] <- NA
rasterImage(img, xleft, ybottom, xright, ytop, interpolate=TRUE)
}
abline(lm(PE_sub$spruce_score1_bayenv~abs(PE_sub$spruce_correlation)))
mtext("Phenotype correlation with environment",side = 1, outer=TRUE)
mtext(PE_pheno_name,side = 3, outer=TRUE)
mtext("Genome Score",side = 2, outer=TRUE)
dev.off()
}#end if not NA
}#end for loop
# this flip column applies to any Bayenv results, including phenotype
ff <- read.table ("~../data/MAT06-BLUEs&Climate-pine.csv", sep = ",", header = T)
ff <- read.table ("../data/MAT06-BLUEs&Climate-pine.csv", sep = ",", header = T)
ee <- ff[complete.cases(ff),]
lm3 <- lm (ee$ColdInjuryMidWinterS02_Mean ~ ee$MAT * ee$HeightFinalS02_mm)
lm4 <- lm (ee$HeightFinalS02_mm ~ ee$MAT * ee$ColdInjuryMidWinterS02_Mean)
lm5 <- lm (ee$MAT ~ ee$HeightFinalS02_mm * ee$ColdInjuryMidWinterS02_Mean)
anova(lm3)
anova(lm4)
anova(lm5)
anova(lm5)
library (rgl)
install.packages("rgl")
library(rgl)
plot3d (ee$MAT,ee$ColdInjuryMidWinterS02_Mean, ee$HeightFinalS02_mm,xlab = "MAT",ylab = "CIFW",zlab = "HEIGHT")
summary(lm3)
summary(lm4)
anova(lm4)
summary(lm5)
anova(lm5)
summary(lm5)
lm4.2 <- lm (ee$HeightFinalS02_mm ~ ee$MAT + ee$ColdInjuryMidWinterS02_Mean)
anova(lm4.2)
summary(lm4.2)
summary(lm3)
summary(lm3)
summary(lm4.2)
summary(lm5)
ff <- read.table ("../data/MAT06-BLUEs&Climate-pine.csv", sep = ",", header = T)
ee <- ff[complete.cases(ff),]
lm3 <- lm (ee$ColdInjuryMidWinterS02_Mean ~ ee$MAT * ee$HeightFinalS02_mm)
head(ee)
plot(ee$Latitude, ee$Longitude, label=ee$ProvincialSeedlotsID)
plot(ee$Latitude, ee$Longitude, labels=ee$ProvincialSeedlotsID)
plot(ee$Latitude, ee$Longitude, label=as.character(ee$ProvincialSeedlotsID))
plot(ee$Latitude, ee$Longitude, labels=as.character(ee$ProvincialSeedlotsID))
plot(ee$Latitude, ee$Longitude,labels = as.character(ee$ProvincialSeedlotsID))
plot(ee$Latitude, ee$Longitude,col=0)
text(ee$Latitude, ee$Longitude,, labels=as.character(ee$ProvincialSeedlotsID))
text(ee$Latitude, ee$Longitude,, labels=as.character(ee$ProvincialSeedlotsID), cex=0.5)
plot(ee$Latitude, ee$Longitude,col=0, bty="n")
text(ee$Latitude, ee$Longitude,, labels=as.character(ee$ProvincialSeedlotsID), cex=0.5)
plot(ee$ColdInjuryMidWinterS02_Mean, ee$HeightFinalS02_mm)
plot(ee$ColdInjuryMidWinterS02_Mean, ee$HeightFinalS02_mm, col=0, bty="n")
text(ee$ColdInjuryMidWinterS02_Mean, ee$HeightFinalS02_mm, labels=as.character(ee$ProvincialSeedlotsID), cex=0.5)
summary(ee$ColdInjuryMidWinterS02_Mean)
summary(ee$ColdInjuryMidWinterS02_Mean)[5]
Height_quads <- summary(ee$HeightFinalS02_mm)
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[1] & ee$HeightFinalS02_mm > Height_quads[1])
CI_quads <- summary(ee$ColdInjuryMidWinterS02_Mean)
Height_quads <- summary(ee$HeightFinalS02_mm)
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[1] & ee$HeightFinalS02_mm > Height_quads[1])
# above 3rd quadrant for hight and CI or below 1st quadrant for height and CI
ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[2])
ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
plot(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],col=0, bty="n", main = "Populations with Tall trees and high cold injury or short trees and low CI")
plot(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],col=0, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
text(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI], labels=as.character(ee$ProvincialSeedlotsID), cex=0.5)
ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
text(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI], labels=as.character(ee$ProvincialSeedlotsID), cex=0.5)
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
text(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI], labels=as.character(ee$ProvincialSeedlotsID), cex=1, pch=20, col="blue")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, pch=20, col="blue")
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, pch=20, col="blue")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, pch=18, col="blue")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue")
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue")
?pch
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24)
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24)
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="orange")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[2])
ShortHighCI_orTallLowCI  <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[2])
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
ShortHighCI_orTallLowCI  <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[2])
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="blue")
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[2])
ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
quartz()
ShortHighCI_orTallLowCI  <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[2])
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="blue")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="blue")
ShortHighCI_orTallLowCI  <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[2])
# above 3rd quadrant for hight and CI or below 1st quadrant for height and CI
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
## Populations with Tall trees and high cold injury or short trees and low CI
TallHighCI_orShortLowCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[2])
# above 3rd quadrant for hight and CI or below 1st quadrant for height and CI
ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
## Populations with Short trees and high cold injury or Tall trees and low CI
ShortHighCI_orTallLowCI  <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5]) | (ee$ColdInjuryMidWinterS02_Mean < CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[2])
# above 3rd quadrant for hight and CI or below 1st quadrant for height and CI
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI")
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-125, -110))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-120, -110))
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-120, -110))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
PopsTallHighCI <- ee$ProvincialSeedlotsID[TallHighCI_orShortLowCI]
PopsShortHighCI <- ee$ProvincialSeedlotsID[ShortHighCI_orTallLowCI]
sum(PopsTallHighCI %in% PopsShortHighCI )
summary(ee$ColdInjuryMidWinterS02_Mean)
summary(ee$HeightFinalS02_mm)
TallHighCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5])
ShortLowCI <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm < Height_quads[2])
TallHighCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm > Height_quads[5])
ShortLowCI <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm < Height_quads[2])
## Populations with Short trees and high cold injury or Tall trees and low CI
ShortHighCI  <- (ee$ColdInjuryMidWinterS02_Mean > CI_quads[5] & ee$HeightFinalS02_mm < Height_quads[2])
TallLowCI <- (ee$ColdInjuryMidWinterS02_Mean < CI_quads[2] & ee$HeightFinalS02_mm > Height_quads[5])
Pops_TallHighCI_ShortLowCI <- ee$ProvincialSeedlotsID[TallHighCI | ShortLowCI]
(Pops_TallHighCI_ShortLowCI <- ee$ProvincialSeedlotsID[TallHighCI | ShortLowCI])
(Pops_ShortHighCI_TallLowCI <- ee$ProvincialSeedlotsID[ShortHighCI | TallLowCI])
sum(Pops_TallHighCI_ShortLowCI %in% Pops_ShortHighCI_TallLowCI)
TallHighCI_orShortLowCI <- TallHighCI | ShortLowCI
ShortHighCI_orTallLowCI <- ShortHighCI | TallLowCI
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
getwd()
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=8, height=14)
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=1, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=1, col="magenta", pch=24, bg="green")
dev.off()
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=8, height=14, bg="white")
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI")
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=2, col="magenta", pch=24, bg="green")
dev.off()
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=8, height=14, bg="white")
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=2, col="magenta", pch=24, bg="green")
dev.off()
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=8, height=14, bg="white")
par(mfrow=c(2,1))
plot(ee$Latitude[!TallHighCI_orShortLowCI], ee$Longitude[!TallHighCI_orShortLowCI],pch=19, cex=0.5, bty="n", main = "Populations with Tall trees and high cold injury\nor short trees and low CI (tradeoff)", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[TallHighCI_orShortLowCI], ee$Longitude[TallHighCI_orShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude[!ShortHighCI_orTallLowCI], ee$Longitude[!ShortHighCI_orTallLowCI],pch=19, cex=0.5, bty="n", main = "Populations with short trees and high cold injury\nor tall trees and low CI (no tradeoff)", xlim=c(48,60), ylim=c(-135, -110))
points(ee$Latitude[ShortHighCI_orTallLowCI], ee$Longitude[ShortHighCI_orTallLowCI],  cex=2, col="magenta", pch=24, bg="green")
dev.off()
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[TallHighCI] <- "TallHighCI"
HeightCI_ind[TallLowCI] <- "TallLowCI"
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[ShortHighCI] <- "ShortHighCI"
HeightCI_ind[TallHighCI] <- "TallHighCI"
HeightCI_ind[TallLowCI] <- "TallLowCI"
HeightCI_ind[ShortLowCI] <- "ShortLowCI"
boxplot(ee$MAT ~ HeightCI_ind)
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
bloxplot(ee$Lat ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$Lat ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$Lat ~ HeightCI_ind, ylab="MAP")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$MAP ~ HeightCI_ind, ylab="MAP")
names(ee)
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[ShortHighCI] <- "2_ShortHighCI"
HeightCI_ind[TallHighCI] <- "1_TallHighCI"
HeightCI_ind[TallLowCI] <- "2_TallLowCI"
HeightCI_ind[ShortLowCI] <- "1_ShortLowCI"
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[ShortHighCI] <- "1_ShortHighCI"
HeightCI_ind[TallHighCI] <- "2_TallHighCI"
HeightCI_ind[TallLowCI] <- "1_TallLowCI"
HeightCI_ind[ShortLowCI] <- "2_ShortLowCI"
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
par(mfrow=c(2,2))
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
pdf("PopulationBoxplot_CIandHeight.pdf", width=12, height=8, bg="white")
par(mfrow=c(2,2))
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
dev.off()
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[ShortHighCI] <- "1_Short\nHigh CI"
HeightCI_ind[TallHighCI] <- "2_Tall\nHigh CI"
HeightCI_ind[TallLowCI] <- "1_Tall\nLow CI"
HeightCI_ind[ShortLowCI] <- "2_Short\nLow CI"
pdf("PopulationBoxplot_CIandHeight.pdf", width=12, height=8, bg="white")
par(mfrow=c(2,2))
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
dev.off()
HeightCI_ind <- rep("middle", nrow(ee))
HeightCI_ind[ShortHighCI] <- "1_Short\nHigh CI\n(sucky trees)"
HeightCI_ind[TallHighCI] <- "2_Tall\nHigh CI\n(tradeoff)"
HeightCI_ind[TallLowCI] <- "1_Tall\nLow CI\n(no tradeoff)"
HeightCI_ind[ShortLowCI] <- "2_Short\nLow CI\n(tradeoff)"
pdf("PopulationBoxplot_CIandHeight.pdf", width=12, height=8, bg="white")
par(mfrow=c(2,2))
boxplot(ee$MAT ~ HeightCI_ind, ylab="MAT")
boxplot(ee$Elevation ~ HeightCI_ind, ylab="Elevation")
boxplot(ee$Latitude ~ HeightCI_ind, ylab="Latitude")
boxplot(ee$log.MAP ~ HeightCI_ind, ylab="MAP")
dev.off()
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand high cold injury \n(sucky trees drive genome-wide pattern)")
quartz()
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand high cold injury \n(sucky trees drive genome-wide pattern)")
points(ee$Latitude[ShortHighCI], ee$Longitude[ShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
points(ee$Latitude[ShortHighCI], ee$Longitude[ShortHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand low cold injury \n(no trade-off, drive genome-wide pattern)")
points(ee$Latitude[TallLowCI], ee$Longitude[TallLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand high cold injury \n(trade-off)")
points(ee$Latitude[TallHighCI], ee$Longitude[TallHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand low cold injury \n(shapes trade-off)")
points(ee$Latitude[ShortLowCI], ee$Longitude[ShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=8, height=14, bg="white")
par(mfrow=c(2,2))
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand high cold injury \n(sucky trees drive genome-wide pattern)")
points(ee$Latitude[ShortHighCI], ee$Longitude[ShortHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand low cold injury \n(no trade-off, drive genome-wide pattern)")
points(ee$Latitude[TallLowCI], ee$Longitude[TallLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand high cold injury \n(shapes trade-off)")
points(ee$Latitude[TallHighCI], ee$Longitude[TallHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand low cold injury \n(shapes trade-off)")
points(ee$Latitude[ShortLowCI], ee$Longitude[ShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
dev.off()
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=14, height=14, bg="white")
par(mfrow=c(2,2))
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand high cold injury \n(sucky trees drive genome-wide pattern)")
points(ee$Latitude[ShortHighCI], ee$Longitude[ShortHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand low cold injury \n(no trade-off, drive genome-wide pattern)")
points(ee$Latitude[TallLowCI], ee$Longitude[TallLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand high cold injury \n(shapes trade-off)")
points(ee$Latitude[TallHighCI], ee$Longitude[TallHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude, ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand low cold injury \n(shapes trade-off)")
points(ee$Latitude[ShortLowCI], ee$Longitude[ShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
dev.off()
ff <- read.table ("../data/MAT06-BLUEs&Climate-pine.csv", sep = ",", header = T)
ee <- ff[complete.cases(ff),]
lm3 <- lm (ee$ColdInjuryMidWinterS02_Mean ~ ee$MAT * ee$HeightFinalS02_mm)
lm4 <- lm (ee$HeightFinalS02_mm ~ ee$MAT * ee$ColdInjuryMidWinterS02_Mean)
lm4.2 <- lm (ee$HeightFinalS02_mm ~ ee$MAT + ee$ColdInjuryMidWinterS02_Mean)
lm5 <- lm (ee$MAT ~ ee$HeightFinalS02_mm * ee$ColdInjuryMidWinterS02_Mean)
anova(lm3)
anova(lm4)
anova(lm4.2)
anova(lm5)
summary(lm3)
summary(lm4)
summary(lm4.2)
summary(lm5)
install.packages("rgl")
pdf("PopulationPlot_ColdInjuryAndHeight.pdf", width=14, height=14, bg="white")
par(mfrow=c(2,2))
plot(ee$Latitude~ ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand high cold injury \n(sucky trees drive genome-wide pattern)")
points(ee$Latitude[ShortHighCI], ee$Longitude[ShortHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude~ ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand low cold injury \n(no trade-off, drive genome-wide pattern)")
points(ee$Latitude[TallLowCI], ee$Longitude[TallLowCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude~ ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Tall trees \nand high cold injury \n(shapes trade-off)")
points(ee$Latitude[TallHighCI], ee$Longitude[TallHighCI],  cex=2, col="blue", pch=24, bg="magenta")
plot(ee$Latitude~ ee$Longitude,pch=19, cex=0.5, bty="n", main = "Populations with Short trees \nand low cold injury \n(shapes trade-off)")
points(ee$Latitude[ShortLowCI], ee$Longitude[ShortLowCI],  cex=2, col="blue", pch=24, bg="magenta")
dev.off()
