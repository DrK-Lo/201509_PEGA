setwd("~/Desktop/CurrResearch/1-AdaptreeData/201509_PEGA")
PE_envi_name <- as.character(PE$Environment[i])
GEA_envi_name <- as.character(PE_matchGEA$Environment_GEA[which(PE_matchGEA$Environment_PE==PE_envi_name)])
PE_pheno_name <- as.character(PE$Phenotype[i])
PE <- read.csv("data/EnvironmentPhenotypeCorrelations-PineSpruce-spearman_v2.csv", header=TRUE)
head(PE)
GWAS_effect_col <- which(results_name==gsub("p","snp_effect", GWAS_pheno_name)
GEA_rho_polarized <- GEA_rho_flip * sign(PE_cor) * sign(GWAS_effect)
library(hexplot)
install.packages(hexplot)
install.packages("hexplot")
library(hexbin)
install.packages("hexbin")
library(hexbin)
install.packages("ggplot")
install.packages("hexbin")
library(hexbin)
plot(hexbin(GWAS_effect, GEA_rho_polarized), ylim=c(-1,1))
?hexbin
?hexbinplot
pdf(paste("analysis/","i_PEGA", sep=""), width=3, height=3)
hexbinplot(GEA_rho_polarized~GWAS_effect, xbnds=c(-5,5), ybnds=c(-1,1), xbins=100, main=paste(PE_envi_name, PE_pheno_name, PE$pine_correlation[i]) , xlim=c(-2,2), ylim=c(-0.5,0.5))
dev.off()
hxb<-hexbin(x=c(-15,-15,75,75),
y=c(-15,-15,75,75),
xbins=12)
hxb@xcm    #gives the x co-ordinates of each hex tile
hxb@ycm    #gives the y co-ordinates of each hex tile
hxb@count  #gives the cell size for each hex tile
points(x=hxb@xcm, y=hxb@ycm, pch=hxb@count)
?hexbinplot
?hexbin
pushHexport(a$plot.vp)
pushHexport(pp$plot.vp)
pine <- read.table("data/large_files/super_outliers_per_variable_pine_both_methods_100x.txt", header=TRUE)
?pch
?grid.points
?unti
?unit
x <- GWAS_effect[superind]
y <- GEA_rho_polarized[superind]
grid.points(x,y,gp=gpar(col="blue"),
pch=8)#,size = unit(0.5, "char"))
popViewport()
pp<- plot(hxb)
pushHexport(pp$plot.vp)
x <- GWAS_effect[superind]
y <- GEA_rho_polarized[superind]
grid.points(x,y,gp=gpar(col=rgb(0,0,1,0.3)),
pch=8,size = unit(0.5, "char"))
popViewport()
pp<- plot(hxb)
pushHexport(pp$plot.vp)
x <- GWAS_effect[superind]
y <- GEA_rho_polarized[superind]
grid.points(x,y,gp=gpar(col=rgb(0,0,1,0.3)),
pch=20,size = unit(0.5, "char"))
popViewport()
par(mfrow=c(2,1), mar=c(4,4,1,1))
plot(a)
hxb_super_t <- hexbin(GWAS_effect[indexes_super_t], GEA_rho_polarized[indexes_super_t],xbnds=c(-5,5), ybnds=c(-1,1), xbins=100)
library(ash)
install.packages("ash")
library(ash)
binned <- bin2(cbind(GEA_rho_polarized, GWAS_effect),
matrix(c(-3,3,-0.5,0.5), 2,2, byrow=TRUE),
nbin=c(100,100))
pdf("Pine.pdf", height=16, width=4)
par(mfrow=c(6,1), mar=c(4,4,4,1))
plotter(GWAS_effect, GEA_rho_polarized, main="All SNPs", is.standard=FALSE)
plotter(GWAS_effect_standardized, GEA_rho_polarized, main="All SNPs Standardized", is.standard=TRUE)
plotter(GWAS_effect_standardized[indexes_super_t], GEA_rho_polarized[indexes_super_t], main="Super tcontigs", is.standard=TRUE)
dev.off()
PE$score_ALL
PE$score_super_t
PE$score_super_t_raw
PE$score_super_g
PE$score_super_g_raw
?image.plot
plot(0,0)
plot(0,0)
legend(-1,1, col=as.numeric(PE$Phenotype), pch=as.numeric(PE$Phenotype),
labels=levels(PE$Phenotype))
legend(-1,1, col=as.numeric(PE$Phenotype), pch=as.numeric(PE$Phenotype),
legend=levels(PE$Phenotype))
names(PE)
?pch
getwd()
gwas_spruce <- read.table("data/large_files/gwas_spruce.bim")
list.files()
gwas_spruce <- read.table("data/large_files/spruce_gwas.bim")
gwas_pine <- read.table("data/large_files/pine_gwas.bim")
head(gwas_spruce)
head(gwas_pine)
gwas_spruce$V5<gwas_spruce$V6
levels(as.factor(gwas_spruce$V5))
levels(gwas_spruce$V5)
levels(gwas_spruce$V6)
levels(gwas_pine$V5)
levels(gwas_pine$V6)
levels(as.numeric(gwas_spruce$V5))
head(gwas_spruce$V5)
as.numeric(gwas_spruce$V5)
head(as.numeric(gwas_spruce$V5))
head(gwas_spruce$V5)
as.numeric(c(TRUE,FALSE))
spruce_ind <- as.numeric(gwas_spruce$V5) < as.numeric(gwas_spruce$V6)
spruce_ind <- as.numeric(as.numeric(gwas_spruce$V5) <
as.numeric(gwas_spruce$V6))
head(spruce_ind)
head(gwas_spruce)
spruce_ind[spruce_ind==0] <- -1
flip_spruce <- read.table("data/large_files/flip_spruce.cor")
gwas_spruce$spruce_ind <- spruce_ind
dim(gwas_spruce)
dim(flip_spruce)
head(gwas_spruce)
head(flip_spruce)
flip_spruce <- read.table("data/large_files/flip_spruce.cor", header=TRUE)
dim(flip_spruce)
head(flip_spruce)
names(gwas_spruce)[2] <- "snp_id"
head(gwas_spruce)
compare_flip <- merge(flip_spruce, gwas_spruce)
head(compare_flip)
dim(compare_flip)
plot(compare_flip$X1, compare_flip$spruce_ind)
abline(compare_flip$spruce_ind~compare_flip$X1)
abline(lm(compare_flip$spruce_ind~compare_flip$X1))
identical(compare_flip$X1, compare_flip$spruce_ind)
equivalent(compare_flip$X1, compare_flip$spruce_ind)
equal(compare_flip$X1, compare_flip$spruce_ind)
same(compare_flip$X1, compare_flip$spruce_ind)
write.table(data.frame(snp_id=gwas_spruce$snp_id,
X1 = gwas_spruce$spruce_ind),
file="flip_spruce_v2.cor", row.names=FALSE)
pine_ind <- as.numeric(as.numeric(gwas_pine$V5) <
as.numeric(gwas_pine$V6))
head(gwas_pine)
head(pine_ind)
pine_ind[pine_ind==0] <- -1
gwas_pine$pine_ind <- pine_ind
dim(gwas_pine)
flip_pine <- read.table("data/large_files/flip_pine.cor", header=TRUE)
dim(flip_pine)
head(flip_pine)
names(gwas_pine)[2] <- "gcontig__gcontig_pos"
head(gwas_pine)
compare_flip_pine <- merge(flip_pine, gwas_pine)
head(compare_flip_pine)
dim(compare_flip_pine)
plot(compare_flip_pine$X1, compare_flip_pine$pine_ind)
abline(lm(compare_flip_pine$pine_ind~compare_flip_pine$X1))
write.table(data.frame(gcontig__gcontig_pos=gwas_pine$gcontig__gcontig_pos,
X1 = gwas_pine$pine_ind),
file="flip_pine_v2.cor", row.names=FALSE)
getwd()
